MERGE INTO BSF01_DEV.DEV1.TGT_SF_STG_CONTACT T
		USING   BSF01_DEV.DEV1.SF_STG_CONTACT D

       ON D.SF_CONTACT_ID = T.SF_CONTACT_ID
WHEN MATCHED AND (T.MAILING_STREET_NM<>D.MAILING_STREET_NM OR
T.MAILING_CITY_NM<>D.MAILING_CITY_NM OR T.MAILING_STATE_CD<>D.MAILING_STATE_CD
OR
T.MAILING_POSTAL_CD<>D.MAILING_POSTAL_CD) THEN
  UPDATE SET T.END_DT = CURRENT_DATE()-1,
             T.UPDATED_BY = D.UPDATED_BY,
			 T.UPDATED_DTTM = CURRENT_TIMESTAMP()
WHEN NOT MATCHED THEN
  INSERT ( MEMBER_PROFILE_ID,
           SF_CONTACT_ID,
           SF_ACCOUNT_ID,
           MEMBER_NM,
           EMAIL_ADDRESS,
           SECONDARY_EMAIL_ADDRESS,
           GENDER_NM,
           BIRTH_DT,
           JOB_TITLE_TXT,
           MAILING_ADDRESS_TYPE_TXT,
           MAILING_STREET_NM,
           MAILING_CITY_NM,
           MAILING_STATE_CD,
           MAILING_POSTAL_CD,
           MAILING_COUNTRY_NM,
           MAILING_LATITUDE,
           MAILING_LONGITUDE,
           HOME_PHONE_NBR,
           WORK_PHONE_NBR,
           CELL_PHONE_NBR,
           MOBILE_PHONE_NBR,
           OTHER_PHONE_NBR,
           PHONE_NBR,
           CHAPTER_LOOKUP_NM,
           BSF_JOBS_IND,
           BSF_MUSEUMS_IND,
           BSF_OUTDOORS_IND,
           BSF_PERKS_IND,
           BSF_THEATRES_IND,
		   BOOKS_ON_BASES_IND,
           CAREER_RESOURCES_IND,
           CAREGIVER_IND,
           CAREGIVER_RESOURCES_IND,
           ESTIMATED_ETS_OR_TRANSITION_DT,
           ETS_OR_TRANSITION_RESOURCES_IND,
           EVENTS_IND,
           HIGHER_LOGIC_USER_IND,
           HIGHER_LOGIC_MODIFIED_DTTM,
           MEMBERSHIP_CATEGORY_NM,
           MILITARY_CHILDREN_RESOURCES_IND,
           MILITARY_FAMILY_AFFILIATION_TXT,
           PARKPASSPORT_IND,
           PCS_MOVE_RESOURCES_IND,
           PRIMARY_BRANCH_AFFILIATION_TXT,
           RACE_OR_ETHNICITY_TXT,
           RACE_OR_ETHNICITY_OTHER_TXT,
           RELATIONSHIP_TO_SERVICE_MEMBER_TXT,
           RESEARCH_AND_POLICY_IND,
           BI_MULTI_RACIAL_TXT,
           VIRTUAL_EVENTS_IND,
           AFFILIATED_MILITARY_STATUS_TXT,
           BSF_MEMBER_OPTED_IN_IND,
           CAREERS_EMAIL_OPT_OUT_IND,
           NUMBER_OF_EMAILS_OPENED_LAST_12_MONTHS_CNT,
           HARD_BOUNCE_IND,
           HARD_BOUNCE_CHANGE_DT,
           EMAIL_OPT_OUT_IND,
           DONOR_IND,
           LEAD_IND,
           LIFECARE_OPT_IN_IND,
           LIFECARE_OPT_IN_DT,
           LOCAL_EVENT_INFO_EMAILS_OPT_OUT_IND,
           LOCAL_NEWSLETTER_EMAIL_OPT_OUT_IND,
           NATIONAL_NEWSLETTER_EMAIL_OPT_OUT_IND,
           TEXT_MESSAGING_TXT,
           LINKEDIN_URL_TXT,
           TWITTER_HANDLE_TXT,
           CONTACT_RECORD_SOURCE_TXT,
           CONTACT_RECORD_SOURCE_UPDATE_TXT,
           BSF_VOLUNTEER_IND,
           VOLUNTEER_APPLICATION_SUBMITTED_IND,
           BSF_VOLUNTEER_OPPORTUNITIES_IND,
           VOLUNTEER_EXPERIENCE_AND_SKILLS_TXT,
           VOLUNTEER_ROLE_INTEREST_TXT,
		   SF_CREATED_BY_ID,
		   SF_CREATED_DTTM,
		   SF_LAST_MODIFIED_BY_ID,
		   SF_LAST_MODIFIED_DTTM,
           START_DT,
           END_DT,
           CREATED_DTTM,
           UPDATED_DTTM,
           CREATED_BY,
		   UPDATED_BY )
  VALUES ( UUID_STRING(),
           D.SF_CONTACT_ID,
           D.SF_ACCOUNT_ID,
           D.MEMBER_NM,
           D.EMAIL_ADDRESS,
           D.SECONDARY_EMAIL_ADDRESS,
           D.GENDER_NM,
           D.BIRTH_DT,
           D.JOB_TITLE_TXT,
           D.MAILING_ADDRESS_TYPE_TXT,
           D.MAILING_STREET_NM,
           D.MAILING_CITY_NM,
           D.MAILING_STATE_CD,
           D.MAILING_POSTAL_CD,
           D.MAILING_COUNTRY_NM,
           D.MAILING_LATITUDE,
           D.MAILING_LONGITUDE,
           D.HOME_PHONE_NBR,
           D.WORK_PHONE_NBR,
           D.CELL_PHONE_NBR,
           D.MOBILE_PHONE_NBR,
           D.OTHER_PHONE_NBR,
           D.PHONE_NBR,
           D.CHAPTER_LOOKUP_NM,
           D.BSF_JOBS_IND,
           D.BSF_MUSEUMS_IND,
           D.BSF_OUTDOORS_IND,
           D.BSF_PERKS_IND,
           D.BSF_THEATRES_IND,
		   D.BOOKS_ON_BASES_IND,
           D.CAREER_RESOURCES_IND,
           D.CAREGIVER_IND,
           D.CAREGIVER_RESOURCES_IND,
           D.ESTIMATED_ETS_OR_TRANSITION_DT,
           D.ETS_OR_TRANSITION_RESOURCES_IND,
           D.EVENTS_IND,
           D.HIGHER_LOGIC_USER_IND,
           D.HIGHER_LOGIC_MODIFIED_DTTM,
           D.MEMBERSHIP_CATEGORY_NM,
           D.MILITARY_CHILDREN_RESOURCES_IND,
           D.MILITARY_FAMILY_AFFILIATION_TXT,
           D.PARKPASSPORT_IND,
           D.PCS_MOVE_RESOURCES_IND,
           D.PRIMARY_BRANCH_AFFILIATION_TXT,
           D.RACE_OR_ETHNICITY_TXT,
           D.RACE_OR_ETHNICITY_OTHER_TXT,
           D.RELATIONSHIP_TO_SERVICE_MEMBER_TXT,
           D.RESEARCH_AND_POLICY_IND,
           D.BI_MULTI_RACIAL_TXT,
           D.VIRTUAL_EVENTS_IND,
           D.AFFILIATED_MILITARY_STATUS_TXT,
           D.BSF_MEMBER_OPTED_IN_IND,
           D.CAREERS_EMAIL_OPT_OUT_IND,
           D.NUMBER_OF_EMAILS_OPENED_LAST_12_MONTHS_CNT,
           D.HARD_BOUNCE_IND,
           D.HARD_BOUNCE_CHANGE_DT,
           D.EMAIL_OPT_OUT_IND,
           D.DONOR_IND,
           D.LEAD_IND,
           D.LIFECARE_OPT_IN_IND,
           D.LIFECARE_OPT_IN_DT,
           D.LOCAL_EVENT_INFO_EMAILS_OPT_OUT_IND,
           D.LOCAL_NEWSLETTER_EMAIL_OPT_OUT_IND,
           D.NATIONAL_NEWSLETTER_EMAIL_OPT_OUT_IND,
           D.TEXT_MESSAGING_TXT,
           D.LINKEDIN_URL_TXT,
           D.TWITTER_HANDLE_TXT,
           D.CONTACT_RECORD_SOURCE_TXT,
           D.CONTACT_RECORD_SOURCE_UPDATE_TXT,
           D.BSF_VOLUNTEER_IND,
           D.VOLUNTEER_APPLICATION_SUBMITTED_IND,
           D.BSF_VOLUNTEER_OPPORTUNITIES_IND,
           D.VOLUNTEER_EXPERIENCE_AND_SKILLS_TXT,
           D.VOLUNTEER_ROLE_INTEREST_TXT,
		   SF_CREATED_BY_ID,
		   SF_CREATED_DTTM,
		   SF_LAST_MODIFIED_BY_ID,
		   SF_LAST_MODIFIED_DTTM,		   
           CURRENT_DATE(),
           '9999-12-31',
           CURRENT_TIMESTAMP(),
           CURRENT_TIMESTAMP(),
           D.CREATED_BY,
           D.UPDATED_BY
           )